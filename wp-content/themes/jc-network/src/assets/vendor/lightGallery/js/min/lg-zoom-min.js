!function(e,o){"function"==typeof define&&define.amd?define([],function(){return o()}):"object"==typeof exports?module.exports=o():o()}(this,function(){!function($,e,o,t){"use strict";var a={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300},r=function(o){return this.core=$(o).data("lightGallery"),this.core.s=$.extend({},a,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=$(e).width()/2,this.pageY=$(e).height()/2+$(e).scrollTop()),this};r.prototype.init=function(){var o=this,t='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';o.core.s.actualSize&&(t+='<span id="lg-actual-size" class="lg-icon"></span>'),this.core.$outer.find(".lg-toolbar").append(t),o.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(e,t,a){var r=o.core.s.enableZoomAfter+a;$("body").hasClass("lg-from-hash")&&a?r=0:$("body").removeClass("lg-from-hash"),o.zoomabletimeout=setTimeout(function(){o.core.$slide.eq(t).addClass("lg-zoomable")},r+30)});var a=1,r=function(t){var a=o.core.$outer.find(".lg-current .lg-image"),r,i,l=($(e).width()-a.width())/2,s=($(e).height()-a.height())/2+$(e).scrollTop();r=o.pageX-l,i=o.pageY-s;var n=(t-1)*r,c=(t-1)*i;a.css("transform","scale3d("+t+", "+t+", 1)").attr("data-scale",t),a.parent().css({left:-n+"px",top:-c+"px"}).attr("data-x",n).attr("data-y",c)},i=function(){a>1?o.core.$outer.addClass("lg-zoomed"):o.resetZoom(),a<1&&(a=1),r(a)},l=function(t,r,l,s){var n=r.width(),c;c=o.core.s.dynamic?o.core.s.dynamicEl[l].width||r[0].naturalWidth||n:o.core.$items.eq(l).attr("data-width")||r[0].naturalWidth||n;var g;o.core.$outer.hasClass("lg-zoomed")?a=1:c>n&&(g=c/n,a=g||2),s?(o.pageX=$(e).width()/2,o.pageY=$(e).height()/2+$(e).scrollTop()):(o.pageX=t.pageX||t.originalEvent.targetTouches[0].pageX,o.pageY=t.pageY||t.originalEvent.targetTouches[0].pageY),i(),setTimeout(function(){o.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)},s=!1;o.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(e,t){var a=o.core.$slide.eq(t).find(".lg-image");a.on("dblclick",function(e){l(e,a,t)}),a.on("touchstart",function(e){s?(clearTimeout(s),s=null,l(e,a,t)):s=setTimeout(function(){s=null},300),e.preventDefault()})}),$(e).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){o.pageX=$(e).width()/2,o.pageY=$(e).height()/2+$(e).scrollTop(),r(a)}),$("#lg-zoom-out").on("click.lg",function(){o.core.$outer.find(".lg-current .lg-image").length&&(a-=o.core.s.scale,i())}),$("#lg-zoom-in").on("click.lg",function(){o.core.$outer.find(".lg-current .lg-image").length&&(a+=o.core.s.scale,i())}),$("#lg-actual-size").on("click.lg",function(e){l(e,o.core.$slide.eq(o.core.index).find(".lg-image"),o.core.index,!0)}),o.core.$el.on("onBeforeSlide.lg.tm",function(){a=1,o.resetZoom()}),o.core.isTouch||o.zoomDrag(),o.core.isTouch&&o.zoomSwipe()},r.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=$(e).width()/2,this.pageY=$(e).height()/2+$(e).scrollTop()},r.prototype.zoomSwipe=function(){var e=this,o={},t={},a=!1,r=!1,i=!1;e.core.$slide.on("touchstart.lg",function(t){if(e.core.$outer.hasClass("lg-zoomed")){var a=e.core.$slide.eq(e.core.index).find(".lg-object");i=a.outerHeight()*a.attr("data-scale")>e.core.$outer.find(".lg").height(),r=a.outerWidth()*a.attr("data-scale")>e.core.$outer.find(".lg").width(),(r||i)&&(t.preventDefault(),o={x:t.originalEvent.targetTouches[0].pageX,y:t.originalEvent.targetTouches[0].pageY})}}),e.core.$slide.on("touchmove.lg",function(l){if(e.core.$outer.hasClass("lg-zoomed")){var s=e.core.$slide.eq(e.core.index).find(".lg-img-wrap"),n,c;l.preventDefault(),a=!0,t={x:l.originalEvent.targetTouches[0].pageX,y:l.originalEvent.targetTouches[0].pageY},e.core.$outer.addClass("lg-zoom-dragging"),c=i?-Math.abs(s.attr("data-y"))+(t.y-o.y):-Math.abs(s.attr("data-y")),n=r?-Math.abs(s.attr("data-x"))+(t.x-o.x):-Math.abs(s.attr("data-x")),(Math.abs(t.x-o.x)>15||Math.abs(t.y-o.y)>15)&&s.css({left:n+"px",top:c+"px"})}}),e.core.$slide.on("touchend.lg",function(){e.core.$outer.hasClass("lg-zoomed")&&a&&(a=!1,e.core.$outer.removeClass("lg-zoom-dragging"),e.touchendZoom(o,t,r,i))})},r.prototype.zoomDrag=function(){var o=this,t={},a={},r=!1,i=!1,l=!1,s=!1;o.core.$slide.on("mousedown.lg.zoom",function(e){var a=o.core.$slide.eq(o.core.index).find(".lg-object");s=a.outerHeight()*a.attr("data-scale")>o.core.$outer.find(".lg").height(),l=a.outerWidth()*a.attr("data-scale")>o.core.$outer.find(".lg").width(),o.core.$outer.hasClass("lg-zoomed")&&$(e.target).hasClass("lg-object")&&(l||s)&&(e.preventDefault(),t={x:e.pageX,y:e.pageY},r=!0,o.core.$outer.scrollLeft+=1,o.core.$outer.scrollLeft-=1,o.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),$(e).on("mousemove.lg.zoom",function(e){if(r){var n=o.core.$slide.eq(o.core.index).find(".lg-img-wrap"),c,g;i=!0,a={x:e.pageX,y:e.pageY},o.core.$outer.addClass("lg-zoom-dragging"),g=s?-Math.abs(n.attr("data-y"))+(a.y-t.y):-Math.abs(n.attr("data-y")),c=l?-Math.abs(n.attr("data-x"))+(a.x-t.x):-Math.abs(n.attr("data-x")),n.css({left:c+"px",top:g+"px"})}}),$(e).on("mouseup.lg.zoom",function(e){r&&(r=!1,o.core.$outer.removeClass("lg-zoom-dragging"),!i||t.x===a.x&&t.y===a.y||(a={x:e.pageX,y:e.pageY},o.touchendZoom(t,a,l,s)),i=!1),o.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},r.prototype.touchendZoom=function(e,o,t,a){var r=this,i=r.core.$slide.eq(r.core.index).find(".lg-img-wrap"),l=r.core.$slide.eq(r.core.index).find(".lg-object"),s=-Math.abs(i.attr("data-x"))+(o.x-e.x),n=-Math.abs(i.attr("data-y"))+(o.y-e.y),c=(r.core.$outer.find(".lg").height()-l.outerHeight())/2,g=Math.abs(l.outerHeight()*Math.abs(l.attr("data-scale"))-r.core.$outer.find(".lg").height()+c),d=(r.core.$outer.find(".lg").width()-l.outerWidth())/2,u=Math.abs(l.outerWidth()*Math.abs(l.attr("data-scale"))-r.core.$outer.find(".lg").width()+d);(Math.abs(o.x-e.x)>15||Math.abs(o.y-e.y)>15)&&(a&&(n<=-g?n=-g:n>=-c&&(n=-c)),t&&(s<=-u?s=-u:s>=-d&&(s=-d)),a?i.attr("data-y",Math.abs(n)):n=-Math.abs(i.attr("data-y")),t?i.attr("data-x",Math.abs(s)):s=-Math.abs(i.attr("data-x")),i.css({left:s+"px",top:n+"px"}))},r.prototype.destroy=function(){var o=this;o.core.$el.off(".lg.zoom"),$(e).off(".lg.zoom"),o.core.$slide.off(".lg.zoom"),o.core.$el.off(".lg.tm.zoom"),o.resetZoom(),clearTimeout(o.zoomabletimeout),o.zoomabletimeout=!1},$.fn.lightGallery.modules.zoom=r}(jQuery,window,document)});