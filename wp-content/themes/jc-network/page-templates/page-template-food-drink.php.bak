<?php
/**
 * Template Name: Food & Drink
 *
 * @link https://codex.wordpress.org/Template_Hierarchy
 *
 * @package jc-network
 */

function jc_grid_assets() {
	wp_enqueue_script( array('justified-js','masonry-js') );
}
add_action( 'wp_enqueue_scripts', 'jc_grid_assets' );

get_header();
	do_action( 'jc_network_before_full_width_content_area' );
		while ( have_posts() ) : the_post();
		?>
		<article id="post-<?php the_ID(); ?>" <?php post_class(); ?>>
			<?php get_template_part( 'template-parts/hero/hero-parent' ); ?>
		
			<div class="entry-content">
				<?php get_template_part( 'template-parts/content/content-section-intro' ); ?>
		
				<section class="uk-container uk-container-center masonry-container">
					<div class="masonry-tiles">
					<?php
						$args = array( 'hide_empty=1' );
						 
						$terms = get_terms( 'food_drink_category', $args );
						
						if ( ! empty( $terms ) && ! is_wp_error( $terms ) ) :
							$count = count( $terms );
							
							$i = 0;
							
							$term_list = '';
							
							foreach ( $terms as $term ) :
								$i++;
								
								$thumb_array = get_field('masonry_image', $term);
								$thumb_id = $thumb_array['id'];
								
								$term_list .= '<a href="' . esc_url( get_term_link( $term ) ) . '" class="masonry-link">';
									$term_list .= wp_get_attachment_image( $thumb_id, 'full', '', array( 'class' => 'full-width-image' ) );
									$term_list .= '<h4 class="caption caption-visible overlay-orange">' . $term->name . '</h4>';
								$term_list .= '</a>';
							endforeach;
						
							$term_list .= '';
						
							echo $term_list;
						endif;
					?>
					</div>
				</section>
		
				<section class="uk-container uk-container-center">
					<div class="section-search-container">
						<div class="section-search">
							<h2 class="uk-text-left section-heading">Search <?php the_title(); ?></h2>
							
							<?php get_template_part( 'template-parts/search/search-sections' ); ?>
						</div>
					</div>
				</section>
		
				<section class="uk-container uk-container-center section-spacing">
					<div class="widgets-section two-widgets">
						<div class="uk-grid uk-grid-width-medium-1-2 uk-grid-width-1-1" data-uk-grid-margin>
							<div class="primary-widget">
								<?php get_template_part( 'template-parts/widget/widget-newsletter-signup-featured' ); ?>
							</div>
		
							<div class="primary-widget">
								<?php get_template_part( 'template-parts/widget/widget-events' ); ?>
							</div>
						</div>
					</div>
				</section>
			</div><!-- .entry-content -->
		
			<footer class="screen-reader-text entry-footer">
			</footer><!-- .entry-footer -->
		</article><!-- #post-## -->
		<?php
		endwhile;
	do_action( 'jc_network_after_full_width_content_area' );
get_footer();
