/*
 * rowGrid.js - v1.1.1
 *
 * A small, lightweight JavaScript plugin for placing items in straight rows
 * as seen at Pexels https://www.pexels.com
 *
 * Copyright (c) 2018 brunjo https://github.com/brunjo/rowGrid
 *
 * Licensed under the MIT license.
 */
var rowGrid=function(t,e){function i(t,e,i){var a=0,s=[],r=(i=Array.prototype.slice.call(i||t.querySelectorAll(e.itemSelector))).length;singleImagePerRow=!!window.matchMedia&&!window.matchMedia("(min-width:"+e.minWidth+"px)").matches;var n=getComputedStyle(t);t=Math.floor(t.getBoundingClientRect().width)-parseFloat(n.getPropertyValue("padding-left"))-parseFloat(n.getPropertyValue("padding-right")),n=[];for(var l,g,o,h=0;h<r;++h)(l=i[h].getElementsByTagName("img")[0])?((g=parseInt(l.getAttribute("width")))||l.setAttribute("width",g=l.offsetWidth),(o=parseInt(l.getAttribute("height")))||l.setAttribute("height",o=l.offsetHeight),n[h]={width:g,height:o}):(i.splice(h,1),--h,--r);for(l=0;l<r;++l){if(i[l].classList?(i[l].classList.remove(e.firstItemClass),i[l].classList.remove(e.lastRowClass)):i[l].className=i[l].className.replace(new RegExp("(^|\\b)"+e.firstItemClass+"|"+e.lastRowClass+"(\\b|$)","gi")," "),a+=n[l].width,s.push(i[l]),l===r-1)for(h=0;h<s.length;h++){0===h&&(s[h].className+=" "+e.lastRowClass);var d="width: "+n[l+parseInt(h)-s.length+1].width+"px;height: "+n[l+parseInt(h)-s.length+1].height+"px;";h<s.length-1&&(d+="margin-right:"+e.minMargin+"px"),s[h].style.cssText=d}if(a+e.maxMargin*(s.length-1)>t||singleImagePerRow){g=a+e.maxMargin*(s.length-1)-t,h=s.length,(e.maxMargin-e.minMargin)*(h-1)<g?(o=e.minMargin,g-=(e.maxMargin-e.minMargin)*(h-1)):(o=e.maxMargin-g/(h-1),g=0);var m=null,p=0;for(h=0;h<s.length;h++){var w=s[h],f=(d=n[l+parseInt(h)-s.length+1].width)-d/a*g;m=m||Math.round(n[l+parseInt(h)-s.length+1].height*(f/d)),.5<=p+1-f%1?(p-=f%1,f=Math.floor(f)):(p+=1-f%1,f=Math.ceil(f)),d="width: "+f+"px;height: "+m+"px;",h<s.length-1&&(d+="margin-right: "+o+"px"),w.style.cssText=d,0===h&&e.firstItemClass&&(w.className+=" "+e.firstItemClass)}s=[],a=0}}}if(null!==t&&void 0!==t)if("appended"===e){e=JSON.parse(t.getAttribute("data-row-grid"));var a=t.getElementsByClassName(e.lastRowClass)[0];a=function(t){for(var e=[t];(t=t.nextSibling)&&9!==t.nodeType;)1===t.nodeType&&e.push(t);return e}(a),i(t,e,a)}else e?(void 0===e.resize&&(e.resize=!0),void 0===e.minWidth&&(e.minWidth=0),void 0===e.lastRowClass&&(e.lastRowClass="last-row")):e=JSON.parse(t.getAttribute("data-row-grid")),i(t,e),t.setAttribute("data-row-grid",JSON.stringify(e)),e.resize&&window.addEventListener("resize",function(a){i(t,e)})};"object"==typeof exports&&(module.exports=rowGrid);
